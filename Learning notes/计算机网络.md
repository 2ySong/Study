# 第一章 概述

> 重点：TCP/IP协议。**Transmission** Control Protocol

## 1.1 计算机网络和互联网

- **计算机网络**(简称**网络**）：由若干个**结点**(node)和连接这些结点的**链路**(link)组成。
- 互联网：是全球最大的、由众多异构网络而成的计算机网络，是**网络中的网络**。
- 特点
  - 连通性：将用户终端彼此联通。
  - 资源共享：信息共享、软件共享、硬件共享。

### 互联网概况

- 连接到互联网的设备被称为**主机**或**端系统**。
- 主机通过**通信链路**和**分组交换机**连接在一起。
- **分组交换机**被称为**路由器**。
- 互联网中，主机和路由器都被称为**结点**。
- 每个ISP都管理看至少一个网络，ISP网络的规模可以是区域性、国家级甚至是国际范围。
- 大型ISP网络覆盖的地理范围在位置上可能重叠。位于相同城市的ISP可以将它们的网络连接到**互联网交换点IXP**,以方便交换流量。
- 互联网的==拓扑结构==虽然非常复杂，但从其工作方式上看，可以分为两大部分
  - **网络边缘**: 网络边缘部分由所有连接在互联网上的主机以及接入网构成。网络边缘部分是用户直接使用的。
  - **网络核心**: 网络核心部分由SP网络、其它网络以及连接这些网络的路由器组成。网络核心部分是为网络边缘部分提供通信服务的。

### 互联网标准化

- 互联网领域重要的标准化组织
  1. **互联网体系结构委员会IAB** RFC文档如TCP协议、P协议等。
  2. **万维网联盟W3C** Web技术标准如HTML、CSS等。
  3. **电气和电子工程师协会IEEE** 802系列标准如以太网标准、WLAN标准等。
- RFC文档按照发表时间的先后顺序编号，并非所有的RFC都能成为互联网标准。

## 1.2 网络边缘

- 网络边缘部分由所有连接在互联网上的**主机**以及**接入网**构成。
- **接入网**包括: ADSL接入、光纤同轴混合网、FTTH接入、以太网接入、WiFi接入以及蜂窝移动接入等。
- 不同的接入网中使用了不同的传输媒体。
- **传输媒体**包括: 双绞线、同轴电缆、光纤以及自由空间等。

### 1.2.1 接入网

1. **ADSL接入**

   ADSL指**非对称数字用户线**, 采用频分复用技术把用户线分成了**电话**、**上行数据**和**下行数据**三个相对独立的信道。用户可以边打电话边上网。

   - 支持的速率
     - ADSL上行速率达到640kbit/s;下行速率达到6Mbit/s
     - ADSL2支持上行速率800kbit/s,下行速率8Mbit/s
     - ADSL2+将频谱范围从1.1MHz扩展到22MHz,下行速率可达16Mbit/s,上行速率仍保 持在800 kbit/s。

2. **光纤同轴混合网HFC**

   **光纤同轴混合网HFC**是利用有线电视网现有的基础设施,提供的一种宽带接入网。
   
   - 支持的速率
     - 适用于HFC网络的有线电缆数据服务接口规约 DOCSIS最初提供上行10Mbit/s,下行40Mbit/s的速率。
     - 目前,最新的 DOCSIS3.1版本,其上下行速率最高均可达10Gps。

3. **FTTH接入**

   **光纤到户FTTH**是FTT×技术的一种最常用的FTTH实现方案是无源光网络PON。

   - PON分为: 窄带PON、APON(ATM PON) ERON(EthernetPON) FAGPON(Gigabit PON)等
   - 支持的速率
     - EPON支持上行、下行传输速率1Gbs
     - GPON下行传输速率可达25Gbit/s, 上行速率可达1.25Gbit/s。

4. **以太网接入和WIFI接入**
   - 通过以太网将主机连接到边缘路由器的方法, 称为**以太网接入**。
   - 通过无线局域网的接入，称为**WiF接入**。
5. **蜂窝移动接入**
   - 通过蜂窝移动网络, 将主机连接到互联网的方法称为蜂窝移动接入。
   - 蜂窝移动技术的发展已经经历了4代, 俗称:1G、2G、3G和4G，第5代(5G)标准正在制定中。

### 1.2.2 传输媒体

<img src="https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109152357289.png" alt="image" style="zoom: 33%;" />

## 1.3 网络核心

- 网络核心部分**各种网络**以及连接这些网络的**路由器**组成。
- 网络核心部分为网络边缘部分的主机提供通信服务。
- 计算机网络采用**分组交换方式**, 路由器是网络核心部分最重要的设备, 是实现分组交换的关键构件,其作用是将收到的分组转发到另一个网络。

### 1.3.1 交换的方式

- 在端系统数量很少时，可以采用==全互联方法==实现点对点通信。
- 但全互联方式中，需要N(N-1)/2条互连线。当增加第N+1个端系统时，必须增设N条线路。
- 因此，引入交换设备。称为==**交换机**==（交换节点）。
- 当交换范围变大，众多交换节点组成**交换网**。
- 实现通信必须要有多种交换方式，**电路交换，分组交换和报文交换**最为典型。
  - 传统的电话网络采用电路交换方式;
  - 计算机网络采用分组交换方式；
  - 早期的电报网络采用报文交换方式。

> 从通信资源分配的角度来看，交换就是按照某种方式分配传输线路的资源。

#### 电路交换

- **电路交换属于通信资源的预分配系统**。

- 电路交换方式时==面向连接==的交换方式，必须经过：
  1. 建立连接: 例如打电话拨号
  2. 数据传输: 例如通话;
  3. 释放连接: 例如挂断电话。
- 特点：**固定分配资源**

#### 分组交换

- 计算机网络数据具有突发特性，如果使用电路交换方式，通信资源的利用率将极低。

> 因此，计算机网络采用**分组交换方式**。分组交换技术的出现奠定了互联网发展的基础。

- 分组交换属于通信资源的**动态分配系统**。

- **特点**：
  - 分组；
  - 存储转发；
  - 逐段占用通信链路资源；
  - 虚电路或数据报。

1. **分组**

- ==分组==是互联网中传输的数据单元

- 待发送的完整数据块称为**报文**(message)

  ![image-20210916195049936](https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109161950542.png)

- 将报文分成较小的数据段，在每个数据段前增加控制信息，构成**分组**(parket)，分组也叫**包**。
- 该段控制信息叫==首部（**包头**）==

2.**存储转发**

- 在互联网中，分组交换节点也叫做**路由器。**

- 路由器收到一个分组后

  1. 先暂时存储起来

  2. 然后根据首部中的控制信息，找到合适的接口将分组转发出去。

- 这种工作方式称为==存储转发==。

3.**逐段占用通信资源**

两种分组方式：虚电路方式和数据报方式

- 虚电路：面向连接
- 数据报：无连接

### 1.3.2 交换的性能

- ==传输时延==: 结点将分组传输到链路上所需要的时间，也称为发送时延。

  $\boxed{发送时延=\frac {发送时还分组长度(bit)}{发送速率(bit/s)}}$

- ==传播时延==:电磁波在信道中传播一定的距离所花费的时间称为传播时延。

  $\boxed{传播时延=\frac {信道长度(m)}{电磁波在信道上的传播速率(m/s)}}$

- ==丢包率==：反映了网络的堵塞程度

  $\boxed{丢包率=\frac {N_s-N_r}{N_s}}$
  - 其中N~s~代表发送的分组总数，N~r~代表收到的分组总数，N~s~-N~r~代表丢失的分组总数。

- ==利用率==：$\boxed{D=\frac {D_0}{1-U}}$

  - 其中，D表示网络当前的时延，D表示网络空闲时的时延，∪是网络的利用率。
  - **信道或网络的利用率过高会产生非常大的时延**。

## 1.4 网络体系结构

### 1.4.1 分层、协议和服务

- 为了降低网络设计的复杂性, 绝大多数网络都按照“==分层==”的方法进行设计。

- 在分层设计思想中, **每一层都建立在下一层的基础之上**, 下层向上一层提供特定的服务。

- ==对等层的双方之间的约定称为协议==。

- 每层协议都完全独立于其它层的协议, 完成菡层的功能。

- 分层的设计方式具有==**灵活性好、耦合性低**==等优点,  并且易于开发和维护，方便进行标准化工作。

- 在互联网中，为进行网络中的数据交换而建立的规则、标准和约定称为网络协议，简称为协议。

  网络协议主要由以下**三个要素**组成

  ​	①语法: 即数据与控制信息的格式;

  ​	②语义: 即控制信息的含义;

  ​	③同步: 即事件顺序的详细说明。

  - 各层所有协议的集合被称为==协议栈==或==协议族==。

  - 任何发送或接收消息的硬件或软件进程称为**实体**。在不同主机上,相对应层次上的实体称为**对等实体**。

  
  - 每层协议的实现都保证了向上层实体提供服务。
  
- 服务和协议的关系

  <img src="https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109161408961.png" alt="image-20210916140507383" style="zoom: 50%;" />

  - **协议是水平方向上的**，控制着==对等实体==间的信息交换。
    - 数据单位为：**协议数据单元PDU**
  - **服务是垂直方向上的**，控制着==相邻层次实体==间的信息及换。
    - 数据单位为：**服务数据单元SDU**

### 1.4.2 互联网体系结构

- 定义：**层**和**协议**的结合成为**网络体系结构。**
- **TCP协议族**作为 BSD Unⅸx的一部分,随看Unix的流行,抢先在全球大范围内成功地运行，成为了互联网上==**事实的国际标准**==。

#### **五层协议栈**

<img src="https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109161122665.png" alt="image-20210916112215326" style="zoom: 25%;" />

##### 第五层-应用层

- **主要任务:** 通过进程间的通信解决某一类应用问题。
- **常见协议:** 域名系统DNS; 超文本传送协HTTP; 动态主机配置协议DHCP; 简单邮件传送协议SMTP等。
- **协议数据单元**: ==报文==。

##### 第四层-运输层

- **主要任务**：向应用提供==端到端==的通信服务。

- **常见协议**：

  - ==传输控制协议TCP==：面向连接、可靠；

  - ==用户数据报协UDP==：无连接、不可靠。

- **协议数据单元**：

  - TCP：报文段
  - UDP：用户数据段

##### 第三层-网络层

- **主要任务**：向上级提供==主机到主机==的通信服务。包括路由选择和分组转换。
- **常见的网络层协议有**：网际协议IP；网际控制报文协议ICM；网际组管理协议IGMP；地址解析协议ARP等。
- **协议数据单元**：
  - **IP协议**：IP分组或IP数据报。

##### 第二层-数据链路层

**主要任务**：向上层提供==相邻节点==间的通信服务。

**常见协议**：以太网Ethernet协议、点对点PPP协议、无线局域网WLAN协议等。

**协议数据单元**：帧

##### 第一层-物理层

- **主要任务**：透明的传输比特流、

- **常见协议**：与实际的传输媒体相关，在不同的传输媒体上定义了不同的物理层协议。

- **协议数据单元**：==**码元**==。

  > 一个码元可以理解为一个脉冲信号，一个码元可以携带一比特信息,也可以携带多比特信息，也允许多个码元一起携带一比特信息。

##### 层级协议图

<img src="https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109161443213.png" alt="image-20210916144052275" style="zoom:33%;" />

### 1.4.3 封装和解封

- 逐层封装的过程发生在发送数据时。
- 逐层解封的过程发生在接受数据时。

### 1.4.4 复用和分用



<img src="https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109161443036.png" alt="image-20210916144310031" style="zoom:33%;" />

## 1.5 控制平面与数据平面

# 第二章 IP地址

## 2.1 IP地址概述

- 在TCPP体系结构中,IP地址是一个最基本的概念。连接到互联网的每台设备至少具有一个IP地址。
- Internet地址的要求
  1. 能够指定对象的位置
  2. 保证地址的唯一性
  3. 地址的格式要便于计算机计算
- IP地址是互联网中使用的网络层地址, 用来标识一台==主机==。严格来说, IP地址用来标识主机上的网络接口。
- IP地址现在由互联网名字和数字分配机构ICANN负责分配和管理。
- IP地址是一个32位的二进制数, 为了便于书写和记忆, |P地址采用==**点分十进制记法**==表示。

![image-20210923111831380](https://gitee.com/song-zhangyao/mapdepot1/raw/master/typora/202109231118474.png)

- P地址采用了分层( hierarchica)结构,即P地址由对应互联网某种层次结
  构的几个部分构成
  P地址包括两部分:网络部分和主机部分
  P地址的网络部分指明主机连接到哪个网络,所有连到同一网络上的主机,
  其P地址的网络部分相同。
  P地址的主机部分唯一标识了特定网络中的一台主机。
  采用分层结构的地址后,路由器可以仅根据|P地址的网络部分来转发分组
  而无需考虑P地址的主机部分。

## 2.2 分类编址

## 2.3 子网划分

## 2.4 无分类编址

## 2.5 特殊用途的IP地址

## 2.6 IP地址的规划和分配